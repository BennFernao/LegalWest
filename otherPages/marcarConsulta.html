<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>LegalWest</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free HTML Templates" name="keywords">
    <meta content="Free HTML Templates" name="description">

    <!-- Favicon -->
    <link href="img/logo.png" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&family=Roboto:wght@300;500;700&display=swap" rel="stylesheet"> 

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="/css/style.css" rel="stylesheet">
</head>

<body >
    

<!-- Header Start -->
<div >
    <!--Barra de contactos-->
   <div class=" bg-secondary border-bottom d-none d-lg-flex ">
       <div class="col-lg-7 text-left">
           <div class="h-100 d-inline-flex align-items-center py-2 px-3">
               <i class="fa fa-envelope text-primary mr-2"></i>
               <small class="text-primary">info@Legalwest.eu</small>
           </div>
           <div class="h-100 d-inline-flex align-items-center py-2 px-2">
               <i class="fa fa-phone-alt text-primary mr-2"></i>
               <small class="text-primary">Angola : + 244 937 579 404, Portugal : +351 21 317 36 60</small>
           </div>
       </div>
       <div class="col-lg-5 text-right">
           <div class="d-inline-flex align-items-center p-2">
               <a class="btn btn-sm btn-outline-primary btn-sm-square mr-2" href="">
                   <i class="fab fa-facebook-f"></i>
               </a>
               <a class="btn btn-sm btn-outline-primary btn-sm-square mr-2" href="">
                   <i class="fab fa-twitter"></i>
               </a>
               <a class="btn btn-sm btn-outline-primary btn-sm-square mr-2" href="">
                   <i class="fab fa-linkedin-in"></i>
               </a>
               <a class="btn btn-sm btn-outline-primary btn-sm-square mr-2" href="">
                   <i class="fab fa-instagram"></i>
               </a>
               <a class="btn btn-sm btn-outline-primary btn-sm-square mr-2" href="">
                   <i class="fab fa-youtube"></i>
               </a>
           </div>
       </div>
   </div>


   <!--Barra de navegação-->
   <div class="bg-secondary w-100">   
       <nav class="navbar navbar-expand-lg   navbar-light " >

           <!--Logotipo para ecras menores que lg-->

           <a href="/index.html" class="navbar-brand d-flex d-lg-none">
               <img src="/img/LegalWest.png" alt="teste" class="img-fluid" width="120px" />              
           </a>

           <!--O botão toggle para ecras menores que lg-->
           <button type="button" class="navbar-toggler bg-primary" data-toggle="collapse" data-target="#navbarCollapse">
               <span class="navbar-toggler-icon"></span>
           </button>


           <!--NavBar collapse para telas menores que só aparecerão no lg-->
           <div class="collapse w-100  " id="navbarCollapse">
               <div class="d-sm-block d-lg-none">
                   <!--Navegação-->
                   <div class=" p-4">
                       <div class="navbar-nav mr-auto py-0 ml-auto " >
                           <a href="/index.html" class="nav-item nav-link text-white ">Home</a>
                           <a href="/team.html" class="nav-item nav-link text-white ">Equipa</a>
                           <a href="/locations.html" class="nav-item nav-link text-white ">Localizações</a>
                           <a href="/contact.html" class="nav-item nav-link text-white ">Contacto</a>

                           <div class ="navbar-nav mr-auto py-0 ">   
                            <div class="nav-item dropdown " >
                                <div class="d-flex justify-content-center align-items-center nav-link dropdown-toggle text-white" data-toggle="dropdown">
                                    <a href="#" class="text-white" >
                                        Quem Somos
                                    </a>
                                    
                                </div>
                                <div class="dropdown-menu rounded-0 m-0 bg-secondary">
    
                                    <div class="dropdown-item d-flex justify-content-start align-items-center  " >
                                        
                                        <a href="/service.html"  class="text-white" >
                                            Serviços
                                        </a>
                                        
                                    </div>
    
                                    <div class="dropdown-item d-flex justify-content-start align-items-center  " >
                                        
                                        <a href="/about.html"  class="text-white" >
                                            informações
                                        </a>
                                        
                                    </div>
    
                                    <div class="dropdown-item d-flex justify-content-start align-items-center  " >
                                        
                                        <a href="/about.html"  class="text-white" >
                                            Blog
                                        </a>
                                        
                                    </div>
                                    
                                </div>
                            </div>
                            </div>

                           <div class="d-flex justify-content-start align-items-start mt-3 ">
                               <img src="/img/translate.svg" width="30px" />
                           
                               <div class ="navbar-nav mr-auto py-0 ml-3">   
                                <div class="nav-item dropdown" >
                                 <div class="nav-link dropdown-toggle d-flex justify-content-center align-items-center" data-toggle="dropdown" >
                                 <div class="d-flex justify-content-center align-items-center">
                                     <img src="/img/portugal.png" style="width: 20px; height: 20px;margin-right: 2px;"/> 
                                    <a href="#"  >
                                        Português
                                    </a>
                                 </div>
                                 </div>
                                    <div class=" dropdown-menu rounded-0 m-0">
                                         <div class="d-flex justify-content-center align-items-center">
                                             <img src="/img/english.png" style="width: 20px; height: 20px;margin-right: 2px;"/> 
                                             <a href="/api/enmarcarConsulta" class="dropdown-item lang">English</a>
                                         </div>                                
                                    </div>
                                </div>
                            </div>
                           </div>

                       </div>
                   </div>

                   <!--Div para a tradução-->
                   <a href="/api/marcarConsulta" class="btn btn-primary mr-5 ml-4 mb-2" >Marcar Consulta</a>
                   <div class="ml-4 divLogin">
                       <a href="/api/user/logar">
                       <button class="btn btn-outline-primary mr-3">
                           <div class="d-flex justify-content-center align-items-center">
                               <img src="/img/user.svg" class="mr-2  usernameIcon" width="30px" />
                               <span class="username">Entrar</span>
                           </div>             
                       </button>
                   </a>
                   </div>
               </div>
           </div>


           <!--NavBar para telas lg e maiores-->
           <div class="d-none d-lg-flex flex-row justify-content-start align-items-center w-100 " >

               <!--Logotipo-->
               <img src="/img/LegalWest.png" alt="Logotipo Legalwest" width="100px" class="img-fluid d-none d-lg-flex" >

               <!--Navegacao-->
               <div class="navbar-nav mr-auto py-0 " >
                   <a href="/index.html" class="nav-item nav-link text-white ">Home</a>
                   <a href="/team.html" class="nav-item nav-link text-white">Equipa</a>
                   <a href="/locations.html" class="nav-item nav-link text-white">Localizações</a>
                   <a href="/contact.html" class="nav-item nav-link text-white">Contacto</a>

                   <div class ="navbar-nav mr-auto py-0 ">   
                    <div class="nav-item dropdown " >
                        <div class="d-flex justify-content-center align-items-center nav-link dropdown-toggle text-white" data-toggle="dropdown">
                            <a href="#" class="text-white" >
                                Quem Somos
                            </a>
                            
                        </div>
                        <div class="dropdown-menu rounded-0 m-0 bg-secondary">

                            <div class="dropdown-item d-flex justify-content-start align-items-center  " >
                                
                                <a href="/service.html"  class="text-white" >
                                    Serviços
                                </a>
                                
                            </div>

                            <div class="dropdown-item d-flex justify-content-start align-items-center  " >
                                
                                <a href="/about.html"  class="text-white" >
                                    informações
                                </a>
                                
                            </div>

                            <div class="dropdown-item d-flex justify-content-start align-items-center  " >
                                
                                <a href="/about.html"  class="text-white" >
                                    Blog
                                </a>
                                
                            </div>
                            
                        </div>
                    </div>
                    </div>

               </div>

               
              
              

               <!--Div para tradução-->
               <div class="d-flex mr-5">
                   <img src="/img/translate.svg" width="30px" />
               
                   <div class ="navbar-nav mr-auto py-0 ml-auto">   
                       <div class="nav-item dropdown " >
                           <div class="d-flex justify-content-center align-items-center nav-link dropdown-toggle text-white" data-toggle="dropdown">
                               <img src="/img/portugal.png"  style="width: 20px; height: 20px;margin-right: 2px;" />
                               <a href="#" class="text-white" >
                                   Português
                               </a>
                               
                           </div>
                           <div class="dropdown-menu rounded-0 m-0 bg-secondary ">

                               <div class="dropdown-item d-flex justify-content-center align-items-center  text-white" >
                                   <img src="/img/english.png" class=""  style="width: 20px; height: 20px;margin-right: 2px;" />
                                   <a href="/api/enmarcarConsulta"  class="text-white" >
                                       English
                                   </a>
                                   
                               </div>
                               
                           </div>
                       </div>
                   </div>
               </div>

               <!--Div para o login-->

               <div class="divLogin1">
                   <a href="/api/user/logar">
                   <button class="btn btn-outline-primary mr-3">
                       <div class="d-flex justify-content-center align-items-center">
                           <img src="/img/user.svg" class="mr-2 usernameIcon1" width="30px" />
                           <span class="username1">Entrar</span>
                       </div>             
                   </button>
               </a>
               </div>
           
           </div>
       </nav>
   </div>



</div>
<!-- Header End -->

    <div class="d-flex flex-column justify-content-center align-items-center"> 

        <div class="d-flex   justify-content-center etapas p-5" style="background-color: #f9faf9; width: 100%; ">
                       
            <div  style="background-color: #ffffff; display: block; border-color: #000; border-width: 1px; border-style: solid; border-radius: 5px;"  class="z-3 position-relative etapa1">   
                <div >
                    <h4 class="pt-5 text-center">Marcação da consulta por video chamada</h4>
                    <div id="etapas" class="d-flex justify-content-between align-items-center p-5 ">
                        <div class="row w-100 pl-5 pr-5 " >
                            <div class="col-4 p-2 bg-secondary" style="border-radius: 5px;" >
                                <div id="etapa1" >
                                    <h2 class="text-center text-primary fw-bold">1</h2>
                                    <h6 class="text-primary fw-bold text-center">Selecionar Advogado</h6>
                                </div>
                            </div>

                            <div class="col-4">
                                <div id="etapa2" class=" p-3">
                                    <h2 class="text-center text-black-50 ">2</h2>
                                    <h6 class="text-black-50 text-center">Selecionar Horário</h6>
                                </div>
                            </div>

                            <div class="col-4">
                                <div id="etapa3" class="p-3">
                                    <h2 class="text-center text-black-50">3</h2>
                                    <h6 class="text-black-50 text-center">Confirmar Horário</h6>
                                </div>
                            </div>

                        </div>
                    </div>
                    

                    <p class="text-secondary pl-5 pr-5 text-center" style="font-weight: bold;">Selecione o advogado que preferes que o atenda na sua consulta</p>
                    


                    <div class="mt-5"> 
                    <h6 class="pl-5 fw-bold">Pesquise por</h6>
                    <div id="barraDePesquisa" class="d-flex justify-content-center align-items-center mt-3 pl-5 pr-5">

                        <div class="mr-3 w-100">
                            <label>Selecione por  especialidade</label>
                            <select class="form-select  opcoesDeAdvogados"  aria-label="Default select example">
                                <option></option>

                            </select>
                        </div>

                        <div class="ml-3 w-100">  
                            <label selected>Selecione por advogado</label>
                            <select class="form-select  opcoesEspecialidades" aria-label="Default select example" >
                                <option value="vazio"></option>
                                

                            </select>
                        </div>

                    </div>

                    <div style="width: 100%;display: flex; flex-direction: column;justify-content: center;align-items: center;margin-top: 15px;">

                        <div class="spinner-grow  carregador" role="status">                   
                        </div> 

                        
                        <p class="paragrafoAguardando">Carregando advogados...</p>                        
                        

                    </div>




                    </div>




                    <div class="containerAdvogados p-2">

                    </div>

                    <!--    

                    <div id="advogados" class="mt-5 w-100 d-flex justify-content-center">
                        <div class="spinner-border text-dark text-center " role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>

                    </div>
                    -->

                    <div class="p-5">  
                        <div id="containerAlert" class=" p-2">
                        </div>
                    </div>

                    <div id="botaoConfirmar" class="d-flex justify-content-end  pr-3 pb-2">
                        <button class="btn btn-primary proximo1">Próximo</button>
                    </div>

                </div>
            </div>


            <div style="display: none; background-color: #ffffff; border-color: #000; border-width: 1px; border-style: solid; border-radius: 5px;" class="etapa2 z-3 position-relative etapa1"> 
                <h4 class="pt-5 text-center">Marcação da consulta por video chamada</h4>
                <div class="d-flex justify-content-center " >   
                        <div id="etapas" class="d-flex justify-content-between align-items-center p-5">
                        <div class="row w-100 pl-5 pr-5 " >
                            <div class="col-4 p-2 "  >
                                <div id="etapa1" >
                                    <h2 class="text-center text-black-50">1</h2>
                                    <h6 class="text-black-50 text-center">Selecionar Advogado</h6>
                                </div>
                            </div>
    
                            <div class="col-4 bg-secondary" style="border-radius: 5px;">
                                <div id="etapa2" class=" p-3" >
                                    <h2 class="text-center  text-primary fw-bold ">2</h2>
                                    <h6 class="text-primary text-center fw-bold">Selecionar Horário</h6>
                                </div>
                            </div>
    
                            <div class="col-4">
                                <div id="etapa3" class="p-3">
                                    <h2 class="text-center text-black-50">3</h2>
                                    <h6 class="text-black-50 text-center">Confirmar Horário</h6>
                                </div>
                            </div>
    
                        </div>
                        </div>
                </div>

                <div id="barraDePesquisa" class="d-flex flex-column justify-content-center align-items-center mt-3 pl-5 pr-5">

                        
                    <select class="form-select  opcoesDias " aria-label="Default select example">
                        <option selected>Selecione o dia</option>
                    </select>

                    <select class="form-select mt-5 opcoesHorarioDisponiveis" aria-label="Default select example" >
                        <option selected ></option>
                    </select>

                </div>

                <div class="p-5">  
                    <div id="alerta2">

                    </div>
                </div>

                <div  class="d-flex justify-content-between  p-5">

                    <button class="btn btn-primary botaoAnterior2">Anterior</button>
                    <button class="btn btn-primary proximo2">Próximo</button>
                </div>
            </div>


            <div style="display: none;background-color: #ffffff; border-color: #000; border-width: 1px; border-style: solid; border-radius: 5px;" class="etapa3 p-5">
                <h4 class="pt-5 text-center">Marcação da consulta por video chamada</h4> 
                <div class="d-flex justify-content-center mt-5 "  style=" display: none;">   
                    <div style="height: 500px; "  >
                        <div id="etapas" class="d-flex justify-content-between align-items-center">
                        <div class="row w-100" >
                            <div class="col-4 w-100">
                                <div id="etapa1" class=" p-3">
                                    <h2 class="text-center text-black-50 ">1</h2>
                                    <h6 class="text-black-50 text-center">Selecionar Advogado</h6>
                                </div>
                            </div>
                
                            <div class="col-4">
                                <div id="etapa2" class=" p-3">
                                    <h2 class="text-center text-black-50 ">2</h2>
                                    <h6 class="text-black-50 text-center">Selecionar Horário</h6>
                                </div>
                            </div>
                
                            <div class="col-4 bg-secondary" style="border-radius: 5px;">
                                <div id="etapa3" class="p-3">
                                    <h2 class="text-center text-primary fw-bold">3</h2>
                                    <h6 class="text-primary text-center fw-bold">Confirmar Horário</h6>
                                </div>
                            </div>
                
                        </div>
                        </div>
                
                

                
                        <div id="advogados" class="mt-5 w-100 d-flex justify-content-center">
                            <div class="mt-5"> 
                                <div>
                                    <h5>A sua consulta por vídeo chamada foi marcado no seguinte horário</h5>
                                    Dia : <p class="dataMarcada"></p>
                                    Hora : <p class="horarioMarcado"></p>
                                    Advogado : <p class="advogadoMarcado"></p>
                                </div>
                            </div>

                            <!--    
                            <div class="spinner-border text-dark text-center " role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            -->
                
                        </div>
                
                        <div id="botaoConfirmar" class="d-flex justify-content-between mt-5">
                            <button class="btn btn-primary botaoAnterior3 ">Anterior</button>
                            <button class="btn btn-primary finalizar">Finalizar</button>
                        </div>
                
                    </div>
                </div>
            </div>

  

        
        </div>
    </div>




<!-- Footer Start -->
<div class="container-fluid bg-secondary text-white pt-5 px-sm-3 px-md-5" style="margin-top: 90px;">
    <div class="row mt-5">
        <div class="col-lg-4">
            <div class="d-flex justify-content-lg-center p-4" style="background: rgba(256, 256, 256, .05);">
                <i class="fa fa-2x fa-map-marker-alt text-primary"></i>
                <div class="ml-3">
                    <h5 class="text-white">Nosso escritório</h5>
                    <p class="m-0">123 Kinaxixi, Luanda, Angola</p>

                    <p>34 Camp. Pequeno, Lisboa, Portugal</p>
                    
                    <p>123 Escritorio, Fortaleza, Brazil</p>
                    
                   
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="d-flex justify-content-lg-center p-4" style="background: rgba(256, 256, 256, .05);">
                <i class="fa fa-2x fa-envelope-open text-primary"></i>
                <div class="ml-3">
                    <h5 class="text-white">Email </h5>
                    <p class="m-0">info@examplo.com</p>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="d-flex justify-content-lg-center p-4" style="background: rgba(256, 256, 256, .05);">
                <i class="fa fa-2x fa-phone-alt text-primary"></i>
                <div class="ml-3">
                    <h5 class="text-white">Telefone</h5>
                    <p class="m-0">+244 943 934 934</p>
                </div>
            </div>
        </div>
    </div>
    <div class="row pt-5">
        <div class="col-lg-5 col-md-6 mb-5">
            <a href="index.html" class="navbar-brand">
                <h2 class="m-0 mt-n2 display-4 text-primary text-uppercase">Legalwest</h2>
            </a>
            <p>Legalwest é uma rede internacional de prestadores de serviços jurídicos, focada na facilitação e incremento de relações globais, muito especialmente no espaço Lusófono.
                Acompanhando a realidade empresarial cada vez mais multinacional, visa disponibilizar aos representados um mais fácil acompanhamento nas suas importantes decisões.</p>
            <div class="d-flex justify-content-start mt-4">
                <a class="btn btn-lg btn-outline-light btn-lg-square mr-2" href="#"><i class="fab fa-twitter"></i></a>
                <a class="btn btn-lg btn-outline-light btn-lg-square mr-2" href="#"><i class="fab fa-facebook-f"></i></a>
                <a class="btn btn-lg btn-outline-light btn-lg-square mr-2" href="#"><i class="fab fa-linkedin-in"></i></a>
                <a class="btn btn-lg btn-outline-light btn-lg-square" href="#"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
        <div class="col-lg-2 col-md-6 mb-5">
            <h4 class="font-weight-semi-bold text-primary mb-4">Links Populares</h4>
            <div class="d-flex flex-column justify-content-start">
                <a class="text-white mb-2" href="index.html"><i class="fa fa-angle-right mr-2"></i>Home</a>
                <a class="text-white mb-2" href="about.html"><i class="fa fa-angle-right mr-2"></i>Sobre Nós</a>
                <a class="text-white mb-2" href="service.html"><i class="fa fa-angle-right mr-2"></i>Serviços</a>
                <a class="text-white mb-2" href="team.html"><i class="fa fa-angle-right mr-2"></i>Equipa</a>
                <a class="text-white" href="contact.html"><i class="fa fa-angle-right mr-2"></i>Contactos</a>
            </div>
        </div>

        <div class="col-lg-3 col-md-6 mb-5">
            <div class="d-flex mb-4 justify-content-start align-items-center">
                <h4 class="font-weight-semi-bold text-primary mr-3 ">Newsletter</h4>
                <a href="/blog.html"><span>ver artigos</span></a>

            </div>

            <p>Coloque o seu email e receba as noticias do legalWest .</p>
            <div class="w-100">
                <div class="input-group">
                    <input type="text" class="form-control border-0" style="padding: 25px;" placeholder="Seu email" id="emailASubscrever">
                    <div class="input-group-append">
                        <button class="btn btn-primary px-4" id="botaoSubscrever">Assinar</button>
                    </div>

                </div>

                <div id="alertaSubscrever">
                        
                </div>
            </div>
        </div>
    </div>
    <div class="row p-4 mt-5 mx-0 w-100" style="background: rgba(256, 256, 256, .05);">
        <div class="d-flex col-12 justify-content-between align-items-center">
            <p class="m-0 text-white">&copy; <a class="font-weight-bold" href="#">LW</a>.Todos Direitos Reservados.</p>
            <div class="d-flex">
                <a href="/termos.html"> <span class="font-weight-bold mr-5"  href="#">Termos e condições</span></a>
                <a href="/politicas.html"><span class="font-weight-bold " href="#">Politicas e privacidade</span></a>
            </div>

        </div>

    </div>
</div>
<!-- Footer End -->


    <!-- Back to Top -->
    <a href="#" class="btn btn-primary px-3 back-to-top"><i class="fa fa-angle-double-up"></i></a>


    <!-- JavaScript Libraries -->
 
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="/js/verificarUser.js"></script>

    <script src="/js/utils.js"></script>
    <script src="/js/subscricoes/pt.js" ></script>
    

    <script>

        let advogadoEscolhido = null
        let dataEscolhida = null
        let posDia = null
        let horarioEscolhido = null

        const divEtapa1 = document.querySelector(".etapa1")
        const divEtapa2 = document.querySelector(".etapa2")
        const divEtapa3 = document.querySelector(".etapa3")


        async function inicializadorEtapaUm(){



            let elementoSelecionado = null

            // obtendo os elementos necessários
            const containerAlert = document.getElementById("containerAlert")
            const opcoesEspecialidades  = document.querySelector(".opcoesDeAdvogados")
            const opcoesDeAdvogados = document.querySelector(".opcoesEspecialidades")
            const containerAdvogados = document.querySelector(".containerAdvogados")
            const containerHorario = document.querySelector(".containerHorario")
            const containerFinalizacao = document.querySelector(".containerFinalizacao")
            const botaoProximo1 = document.querySelector(".proximo1")



            const paragrafoAguardando = document.querySelector(".paragrafoAguardando")
            const carregador = document.querySelector(".carregador")

        

            let  advogados = await buscarAdvogados()     
            let especialidades = await buscarEspecialidades()
            let copiaDeAdvogados = null

            if(advogados[0] !== "erro" && especialidades[0] !== "erro"){

                paragrafoAguardando.innerText = ""
                carregador.style.display = "none"
                copiaDeAdvogados = advogados.map((item, pos)=> item)



            }else{

                alertaSobrePosts.innerHTML = "<p>Erro ao buscar advogados, tente novamente"
                carregador.style.display = "none"
            }



            botaoProximo1.addEventListener("click", ()=>{ proximaEtapaUm(divEtapa1, divEtapa2, containerAlert)})


            opcoesDeAdvogados.addEventListener("change",  (e)=>{

                const  valor = e.target.value   
                
                
                const advogado = copiaDeAdvogados[valor]

                containerAdvogados.innerHTML = ""
                advogados = [advogado]
                escreverAdvogado({advogado, container: containerAdvogados, posicao: valor, selecionado : false })
      
            })

            opcoesDeAdvogados.addEventListener("click", (e)=>{

                opcoesEspecialidades.value = "vazio"
            })

            opcoesEspecialidades.addEventListener("click", (e)=>{

                opcoesDeAdvogados.value = "vazio"
            })


            opcoesEspecialidades.addEventListener("change",  async (e)=>{

                        
                const valor = e.target.value
                const idEspecialidade = especialidades[valor].id 

                const advogadosEspecializados = await buscarAdvogadosDeUmaEspecialidade(idEspecialidade)

                containerAdvogados.innerHTML = ""
                advogadosEspecializados.forEach((element, i)=>{

                    escreverAdvogado({advogado: element, container: containerAdvogados, posicao: i, selecionado: false})
                })
                
            })


            if(!(advogados[0] == "erro")){

                advogados.forEach((element, i )=> {

                    const opcao = document.createElement("option")
                    opcao.value = i 
                    opcao.innerText = element.nome



                    opcoesDeAdvogados.appendChild(opcao)
                    escreverAdvogado({advogado: element, container: containerAdvogados, posicao: i, selecionado: false })
                    
                
                })   
            }else{

                //Escrever a mensagem de erro
            }


            if(!(especialidades[0] == "erro")){

                especialidades.forEach((element, i )=> {

                    const opcao = document.createElement("option")
                    opcao.value = i 
                    opcao.innerText = element.nome

                    opcoesEspecialidades.appendChild(opcao)
                
                    });
            }else{
                 
                // manipular o erro
            }


            function escreverAdvogado({advogado, container, posicao, selecionado }){

                    const div_1 = document.createElement("div")
                    div_1.setAttribute("class", "d-flex justify-content-between  align-items-center w-100 mt-2 p-2 ")
                    div_1.style.borderRadius = "5px"
                    div_1.style.backgroundColor = "#FDFBFB"

                    const div_1_1 = document.createElement("div")
                    div_1_1.setAttribute("class", "mr-2 d-flex   align-items-center" )


                            const img = document.createElement("img")
                            img.setAttribute("class", "img-fluid mr-3 h-100")
                            img.setAttribute("src", `/img/${advogado.urlImagemPerfil}`)
                            img.style.width = "100px"
                            img.style.borderRadius  = "5px"

                            div_1_1.appendChild(img)

                            const div_1_1_1 = document.createElement("div")

                                const nome = document.createElement("h5")
                                nome.innerText = advogado.nome

                                div_1_1_1.appendChild(nome)

                                const dataDeAtuazacao = document.createElement("p")
                                dataDeAtuazacao.innerText = ` ${advogado.escritorio}`

                                div_1_1_1.appendChild(dataDeAtuazacao)

                            div_1_1.appendChild(div_1_1_1)


                            
                            const div_1_2 = document.createElement("div")
                            div_1_2.className = "form-check"
                        

                                const radio = document.createElement("input")
                                radio.type = "radio"
                                radio.className = "btn-check"
                                radio.style.cursor = "pointer"
                                radio.id = `option${posicao}`
                                radio.name = "options"
                                radio.autocomplete = "off"

                                const label = document.createElement("label")
                                label.className = selecionado ? "btn btn-secondary" : "btn btn-outline-secondary"
                                label.innerText = selecionado ?  "Selecionado" : "Selecionar"
                                label.setAttribute("for", `option${posicao}`)

                                radio.addEventListener("click", (e)=>{

                                    const {id, nome} = advogado
                                    advogadoEscolhido = {id, nome} 

                                    containerAdvogados.innerHTML =  ""

                                    advogados.forEach((adv, pos)=>{

                                        if(posicao == pos){
                                            escreverAdvogado({advogado: adv, container: containerAdvogados, posicao: pos, selecionado : true})
                                        
                                        }else{
                                            escreverAdvogado({advogado: adv, container: containerAdvogados, posicao: pos, selecionado : false})
                                        }


                                        
                                    })
                                              
                                })
                

                            
                            div_1_2.appendChild(radio)
                            div_1_2.appendChild(label)



                    div_1.appendChild(div_1_1)
                    div_1.appendChild(div_1_2)

                    container.appendChild(div_1)

                    }


            async function proximaEtapaUm(divEtapaAtual, divProximaEtapa, divAlert){


                if(!(advogadoEscolhido == null)){

                    divEtapaAtual.style.display = "none"
                    divProximaEtapa.style.display = "block"
                    await inicializadorEtapaDois(advogadoEscolhido.id)
 

                }else{

                    divAlert.className = "alert alert-danger"
                        divAlert.innerText = "Selecione um advogado para a consulta"

                    setTimeout(()=>{

                        divAlert.className = ""
                        divAlert.innerText = ""

                    }, 5000)

                }    
            }
            }

        inicializadorEtapaUm()

        async function inicializadorEtapaDois(idAdvogado){

            scrollTo({
                top: 20,
                behavior:"smooth"
            })

            const containerAlert2 = document.querySelector("#alerta2")
            const botaoAnterior2 = document.querySelector(".botaoAnterior2")

            botaoAnterior2.addEventListener("click", (e)=>{

                divEtapa1.style.display = "block"
                divEtapa2.style.display = "none"

                scrollTo({
                top: 50,
                behavior:"smooth"
                })     
            })

            const {dias: arrayDisponibilidade, horarios : horariosIndicativos } = await horarioDisponibilidade() 
            const consultasDoAdvogado = await buscarAdvogadoConsultasAtivasDeUmAdvogado(idAdvogado)   

            
            const horaInicial = horariosIndicativos[1]
            const horaFinal = horariosIndicativos[2]
            const intervalo = horariosIndicativos[0]

            const intervaloEmMinutos = converterParaMinutos(intervalo)
            let horariosPermitidos = calcularHoras(horaInicial, horaFinal, intervaloEmMinutos)

            console.log(consultasDoAdvogado, arrayDisponibilidade)
            const estruturaDeDisponibilidade = estruturar(arrayDisponibilidade, consultasDoAdvogado)
            const estruturaDosDias = []

            estruturaDeDisponibilidade.forEach((element, i)=>{

                

                        if(element.disponibilidade){
                            
                        
                            const dia = `${element.diaDeSemana} ${element.data}`

                            const horariosDoDia = horariosPermitidos.filter((horario, i)=>{

                                const [diaDoHorario, mesDoHorario, anoDoHorario] =  element.data.split("/")
                                const [diaAtual, mesAtual, anoAtual] = new Date().toLocaleDateString().split("/")

                                
                                let horarioForaDoTempoAtual = null

                                if(diaAtual == diaDoHorario){

                                        const minutosAtuais = new Date().getMinutes().toString()
                                        const horasAtuais = new Date().getHours().toString()

                                        const [horasDisponiveis ,minutosDisponiveis] = horario.split(":")

                                        const tempoAtualEmMinutos = parseInt(horasAtuais)*60 + parseInt(minutosAtuais)
                                        const tempoDisponivelEmMinutos = parseInt(horasDisponiveis)*60 + parseInt(minutosDisponiveis)
                                  

                                        if((tempoDisponivelEmMinutos - tempoAtualEmMinutos) > 45){
                                                console.log("ok", horario)
                                                horarioForaDoTempoAtual = false
                                        }else{
                                            horarioForaDoTempoAtual = true
                                        }
               
                            }

                                return  (!(element.horariosOcupados.includes(horario)) && !horarioForaDoTempoAtual)
                            })

                            estruturaDosDias.push({dia, horarios : horariosDoDia, data : element.data})
                        }

                    })


            const opcoesDias = document.querySelector(".opcoesDias")
            const opcoesHorariosDisponiveis = document.querySelector(".opcoesHorarioDisponiveis")

            opcoesDias.innerHTML = ""

            estruturaDosDias.forEach((hor,i)=>{
            
                    const option = document.createElement("option")
                    option.value = i 
                    option.innerText = hor.dia
                    opcoesDias.appendChild(option)

            })

            opcoesDias.addEventListener("change", (e)=>{

      
            const pos = e.target.value
            dataEscolhida =  estruturaDosDias[pos].data
            horarioEscolhido = estruturaDosDias[pos].horarios[0]
            opcoesHorariosDisponiveis.innerHTML = ""

            estruturaDosDias[pos].horarios.forEach((valor, i)=>{

                const option = document.createElement("option")


                    option.value = i
                    posDia = pos
                    option.innerText = valor
                    opcoesHorariosDisponiveis.appendChild(option)
               
                    
            })


        })

            opcoesHorariosDisponiveis.addEventListener("change", (e)=>{

                const pos = e.target.value 
                
                horarioEscolhido = estruturaDosDias[posDia].horarios[pos]
                
            })


            const proximo = document.querySelector(".proximo2")

            proximo.addEventListener("click", (e)=>{

                proximaEtapaDois(divEtapa2, divEtapa3, containerAlert2)
            })

            async function proximaEtapaDois(divEtapaAtual, divProximaEtapa, divAlert){

                

                    if(!(dataEscolhida == null && horarioEscolhido == null)){

                        inicializadorEtapaTres()
                        
                        divEtapaAtual.style.display = "none"
                        divProximaEtapa.style.display = "block"

                    }else{

                        divAlert.className = "alert alert-danger"
                        divAlert.innerText = "Selecione um horario para a sua reunião"

                        setTimeout(()=>{

                            divAlert.className = ""
                            divAlert.innerText = ""


                        }, 5000)




                    }    
                    }

    }
        
        function inicializadorEtapaTres(){

            const dataMarcada = document.querySelector(".dataMarcada")
            const horarioMarcado = document.querySelector(".horarioMarcado")
            const advogadoMarcado = document.querySelector(".advogadoMarcado")


            dataMarcada.innerText = dataEscolhida
            horarioMarcado.innerText = horarioEscolhido
            advogadoMarcado.innerText = advogadoEscolhido.nome

            const botaoAnterior3 = document.querySelector(".botaoAnterior3")

            botaoAnterior3.addEventListener("click", (e)=>{

                divEtapa2.style.display = "block"
                divEtapa3.style.display = "none"

                scrollTo({
                    top: 50,
                    behavior:"smooth"
                })     
            })


            const finalizar = document.querySelector(".finalizar")


            finalizar.addEventListener("click", (e)=>{

                

                let [dia, mes, ano] = dataEscolhida.split("/").map((item)=> parseInt(item))
                let [hora, minuto] = horarioEscolhido.split(":").map((item)=> parseInt(item))


                const data = new Date(ano, mes - 1, dia, hora, minuto).toISOString()
               

                fetch("/api/consulta/adicionar", {
                    method: "POST",
                    body:JSON.stringify({ data, idAdvogado : advogadoEscolhido.id}),
                    headers : {"content-type": "application/json"}
                }).then(res=> res.json())
                .then((res)=> {

                    if(res[0] == "erro"){
                        alert(res[0])
                        location.reload()

                    }else{

                        alert("Reunião marcada com sucesso")
                        location.reload()

                    }
                })
                .catch((erro)=> {

                    alert("erro ao marcar consulta, tente novamente")
                    location.reload()
                }
                
                )

                

            })
        }


        async function buscarAdvogadoConsultasAtivasDeUmAdvogado(id){

            const resposta = await fetch("/api/consulta/lerConsultasAtivasDeUmAdvogado", {

                method:"POST",
                body:JSON.stringify({id}),
                headers:{"content-type":"application/json"}

            }).then(async (res)=> {

                const dados = await res.json()
                
                return dados})

                .catch((error)=>{
                
                    console.log(error)
                   return   ["erro", "erro ao buscar dados"]
                }
                    )

           
            return resposta
        }



        async function buscarAdvogados(){

            const resposta = await fetch("/api/lawyers/showLawyers")
                                                                .then((res)=> res.json())
                                                                .catch((error)=>["erro", "erro ao buscar dados"])
            return resposta 
        }

        async function buscarUmAdvogado(id){
            
            const resposta = await fetch(`/api/lawyers/lerAdvogado/${id}`)
                                                                .then((res)=> res.json())
                                                                .catch((error)=>["erro", "erro ao buscar dados"])
            return resposta 
        }

        async function buscarAdvogadosDeUmaEspecialidade(idEspecialidade){

            const resposta = await fetch(`/api/especialidade/lerAdvogados/${idEspecialidade}`)
                                                                .then((res)=> res.json())
                                                                .catch((error)=>["erro", "erro ao buscar dados"])
            return resposta 
        }

        async function buscarEspecialidades(){

                const resposta = await fetch("/api/especialidade/lerEspecialidades")
                                                                    .then((res)=> res.json())
                                                                    .catch((error)=>["erro", "erro ao buscar dados"])
                return resposta 
        }

                // Funções utilitárias
    
        async function horarioDisponibilidade(){

                async function buscarDadosDaDisponibilidade(){

                    const resposta = await fetch("/api/horario/lerHorarioAtual",).then((res=> res.json()))
                                                    .catch((erro)=> ["erro", "erro ao enviar a solicitacao"])

                    return resposta
                }

                const dadosHorario = await buscarDadosDaDisponibilidade()
                let  {dias, horario} = dadosHorario
                dias = dias.split(",")
                dias = dias.map((dia)=> parseInt(dia))
                horarios = horario.split(",")


                    return {dias, horarios}
            }

        function estruturar(arrayDisponibilidade, consultasMarcadas){


                                       

                    const diasDeSemana = ["Domingo", "Segunda", "Terça", "Quarta", "Quinta", "Sexta", "Sabado" ]

                    const diaDeSemana = (new Date()).getDay()
                    const dataDeHoje =  new Date().toLocaleDateString()




                    // transformando os dias padronizados em dias atuais
                    let diasPermitidos = diasDeSemana.slice(diaDeSemana, 7).concat(diasDeSemana.slice(0, diaDeSemana))
                    let arrayDisponibilidadeAjustada = arrayDisponibilidade.slice(diaDeSemana, 7).concat(arrayDisponibilidade.slice(0, diaDeSemana))
                    
                    let posicaoOriginalDosDiasAjustados = diasPermitidos.map((dia, pos)=>{

                        const posicao = diasDeSemana.indexOf(dia)
                        return posicao
                    })

                    // Pegando as datas por ordem dos dias de disponibilidade
                    const suasDatas = arrayDisponibilidade.map((item, i)=>{

                        return   new Date(Date.now()+(i*1000*60*60*24)).toLocaleDateString()
                    })

                    
                    
                    const horariosMarcados = consultasMarcadas.map((item, i)=>{

                        
                        const data = converterUTCParaLocal(item.para)
                       
                        const diaDaConsulta = new Date(data).getDay()

                        
                        let horaDaConsulta = new Date(data).getHours()
                        let minutos = new Date(data).getMinutes()



                        horaDaConsulta = horaDaConsulta > 10 ? horaDaConsulta : "0" + horaDaConsulta.toString()
                        minutos = minutos > 10 ? minutos : "0" + minutos.toString()
                        


                        return {
                            diaDaConsulta,
                            data:horaDaConsulta +":"+minutos        
                        }
                    })


                    const estrutura = []

                    console.log(arrayDisponibilidade)

                    arrayDisponibilidadeAjustada.forEach((item, pos)=>{

                        if(item){

                            estrutura.push({
                            diaDeSemana : diasPermitidos[pos],
                            data : suasDatas[pos],
                            disponibilidade : 1,
                            horariosOcupados : []
                            }) 

                        }else{

                            estrutura.push({
                            diaDeSemana : diasPermitidos[pos],
                            data : suasDatas[pos],
                            disponibilidade : 0,
                            horariosOcupados : []
                            }) 

                        }



                    })


                    
                    

                  
                    horariosMarcados.forEach((item, pos)=>{
                        const posicao = posicaoOriginalDosDiasAjustados.indexOf(item.diaDaConsulta)
                        
                        estrutura[posicao].horariosOcupados.push(item.data)
                    })

                   
                    

                    return estrutura
                    }

        function converterParaMinutos(hora) {
                            // Extrai os valores de hora e minutos
                            var parts = hora.split(":");
                            var hours = parseInt(parts[0]);
                            var minutes = parseInt(parts[1]);

                            // Converte as horas para minutos e retorna o resultado como um número inteiro
                            var totalMinutes = hours * 60 + minutes;
                            return totalMinutes;
                            }

        function calcularHoras(horaInicial, horaFinal, intervalo) {

                            var resultado = [];
                            var horaAtual = horaInicial;

                            while (horaAtual <= horaFinal) {
                                resultado.push(horaAtual);

                                // Extrai os valores de hora e minutos da hora atual
                                var parts = horaAtual.split(":");
                                var hours = parseInt(parts[0]);
                                var minutes = parseInt(parts[1]);

                                // Converte as horas para minutos e adiciona o intervalo
                                var timeInMinutes = hours * 60 + minutes;
                                timeInMinutes += intervalo;

                                // Converte o tempo de volta para o formato de hora
                                hours = Math.floor(timeInMinutes / 60);
                                minutes = timeInMinutes % 60;

                                // Formata a hora para exibição
                                horaAtual = (hours < 10 ? "0" : "") + hours + ":" + (minutes < 10 ? "0" : "") + minutes;
                            }

                            return resultado;
                }

        function buscarHorarioDeUmAdvogado(idAdvogado){

                console.log("horario")

                }

        function converterUTCParaLocal(utcDate) {
                    
                    var localTime = new Date(utcDate);

                    return localTime;
            }


        

        const etapas = document.querySelector(".etapas")
        const etapa1Completado = document.querySelector(".etapa1Completado")
        const etapa2Completado = document.querySelector(".etapa2Completado")
          
     
        const etapa1Voltar = document.querySelector(".etapa1Voltar")
        const etapa2Voltar = document.querySelector(".etapa2Voltar")
       
    </script>



    <!-- Template Javascript -->



</body>

</html>